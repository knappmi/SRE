---
# ConfigMap Example
# Store non-sensitive configuration data

apiVersion: v1
kind: ConfigMap
metadata:
  name: app-config
  labels:
    app: demo
data:
  # Simple key-value pairs
  environment: "production"
  log_level: "info"
  feature_flags: "feature-a,feature-b"
  
  # Configuration file
  app.conf: |
    server {
      listen 8080;
      location / {
        root /usr/share/nginx/html;
      }
    }
  
  # JSON configuration
  config.json: |
    {
      "database": {
        "host": "db.example.com",
        "port": 5432,
        "pool_size": 10
      },
      "cache": {
        "enabled": true,
        "ttl": 300
      }
    }
---
# Secret Example
# Store sensitive data (base64 encoded)

apiVersion: v1
kind: Secret
metadata:
  name: app-secrets
  labels:
    app: demo
type: Opaque
data:
  # These should be base64 encoded
  # Use: echo -n 'value' | base64
  database-password: c3VwZXJzZWNyZXRwYXNzd29yZA==  # supersecretpassword
  api-key: YXBpLWtleS0xMjM0NTY3ODkw  # api-key-1234567890
stringData:
  # These are automatically base64 encoded
  service-token: "token-abc123xyz789"
---
# Deployment using ConfigMap and Secret
apiVersion: apps/v1
kind: Deployment
metadata:
  name: app-with-config
  labels:
    app: demo
spec:
  replicas: 2
  selector:
    matchLabels:
      app: demo
  template:
    metadata:
      labels:
        app: demo
    spec:
      containers:
      - name: app
        image: nginx:alpine
        ports:
        - containerPort: 8080
        
        # Environment variables from ConfigMap
        env:
        - name: ENVIRONMENT
          valueFrom:
            configMapKeyRef:
              name: app-config
              key: environment
        - name: LOG_LEVEL
          valueFrom:
            configMapKeyRef:
              name: app-config
              key: log_level
        
        # Environment variables from Secret
        - name: DB_PASSWORD
          valueFrom:
            secretKeyRef:
              name: app-secrets
              key: database-password
        - name: API_KEY
          valueFrom:
            secretKeyRef:
              name: app-secrets
              key: api-key
        
        # Mount ConfigMap as volume
        volumeMounts:
        - name: config-volume
          mountPath: /etc/config
        
        # Mount Secret as volume
        - name: secret-volume
          mountPath: /etc/secrets
          readOnly: true
      
      volumes:
      - name: config-volume
        configMap:
          name: app-config
      - name: secret-volume
        secret:
          secretName: app-secrets
