# ConfigMap and Secret Exercise
#
# OBJECTIVE: Create a ConfigMap and Secret, then use them in a Pod
#
# REQUIREMENTS:
# 1. ConfigMap with application config (database host, port, log level)
# 2. Secret with credentials (database username and password - base64 encoded)
# 3. Pod that mounts both as environment variables
#
# TODO: Complete the manifests below

---
# ConfigMap
apiVersion: v1
kind: ConfigMap
metadata:
  name: # TODO: app-config
data:
  # TODO: Add configuration keys
  # database_host: "postgres.default.svc.cluster.local"
  # database_port: "5432"
  # log_level: "info"

---
# Secret
# Note: Values must be base64 encoded
# Use: echo -n "mypassword" | base64
apiVersion: v1
kind: Secret
metadata:
  name: # TODO: app-secrets
type: Opaque
data:
  # TODO: Add base64 encoded values
  # username: (base64 encoded)
  # password: (base64 encoded)

---
# Pod using ConfigMap and Secret
apiVersion: v1
kind: Pod
metadata:
  name: # TODO: app-pod
spec:
  containers:
  - name: app
    image: busybox:latest
    command: ["sh", "-c", "env && sleep 3600"]
    # TODO: Add environment variables from ConfigMap
    env:
    # Example:
    # - name: DATABASE_HOST
    #   valueFrom:
    #     configMapKeyRef:
    #       name: app-config
    #       key: database_host
    
    # TODO: Add environment variables from Secret
    # - name: DB_USERNAME
    #   valueFrom:
    #     secretKeyRef:
    #       name: app-secrets
    #       key: username
